st_transform("+proj=longlat") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("LongLat projection")
#Plan
ne_countries(scale = 110, returnclass = "sf") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("LongLat projection")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=longlat") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("LongLat projection")
#Plan
ne_countries(scale = 110, returnclass = "sf")
ne_countries(scale = 110, returnclass = "sf")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=merc") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Mercator projection")+
coord_sf( xlim = c(-42, 86), ylim = c(12,84))
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>% proj4string()
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE)
library(rnaturalearth)
library(sf)
library(sp)
library(ggplot2)
library(glue)
# Chunk 2
w <- ne_countries(scale=50, returnclass = "sf")
ne_countries(scale=110, returnclass = "sf") %>%
ggplot() +
geom_sf(fill = "grey", colour = "black") +
ggtitle("Scale=110")
ne_countries(scale=50, returnclass = "sf") %>%
ggplot() +
geom_sf(fill = "grey", colour = "black") +
ggtitle("Scale=50")
ne_countries(scale=10, returnclass = "sf") %>%
ggplot() +
geom_sf(fill = "grey", colour = "black") +
ggtitle("Scale=10")
# Chunk 3
ne_countries(scale=110, returnclass = "sf",continent = "Europe") %>%
ggplot() +
geom_sf(fill = "grey", colour = "black") +
ggtitle("Importation du fond de carte avec filtre sur continent")
ne_countries(scale=110, returnclass = "sf",country = "France") %>%
ggplot() +
geom_sf(fill = "grey", colour = "black") +
ggtitle("Importation du fond de carte avec filtre sur pays")
# Chunk 4
ne_countries(scale=110, returnclass = "sf") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black") +
coord_sf( xlim = c(-42, 86), ylim = c(12,84))
# Chunk 5
#Plan
ne_countries(scale = 110, returnclass = "sf") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Défaut = LongLat projection")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=merc") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Mercator projection")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=mill") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Miller projection")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=gall") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Gall projection")
# Chunk 6
#sphérique
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=natearth + wktext") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=robin") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Robinson projection")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Mollweide projection")
# Chunk 7
xlim = c(-4200000, 8600000)
ylim = c(1200000,8400000)
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Mollweide projection")+
coord_sf(xlim=xlim,ylim=ylim)
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>% projInfo(type = "proj")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>% rgdal::projInfo(type = "proj")
projInfo(type = "proj")
rgdal::projInfo(type = "proj")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll")
latitude_centre <- 52
longitude_centre <- 10
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre}")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
longitude_centre <- 180
latitude_centre <- 0
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_map(xlim=c(-180,180))
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_sf(xlim=c(-180,180))
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_sf(xlim=c(-180,180),ylim=c(-90,90))
par()
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_sf(xlim=c(-180,180),ylim=par()$yaxp)
par()$yaxp
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=moll +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_sf(xlim=par()$usr[1:2],ylim=par()$usr[3:4])
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=longlat +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
latitude_centre <- 52
longitude_centre <- 10
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
longitude_centre <- 180
latitude_centre <- 0
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
latitude_centre <- 90
longitude_centre <- 180
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
latitude_centre <- 52
longitude_centre <- 10
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
latitude_centre <- 0
longitude_centre <- 180
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
latitude_centre <- 0
longitude_centre <- 0
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
latitude_centre <- 52
longitude_centre <- 10
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=gall +lat_0={latitude_centre} +lon_0={longitude_centre}")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=gall +lat_0={latitude_centre} +lon_0={longitude_centre}") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Gall projection")
latitude_centre <- 0
longitude_centre <- 10
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=gall +lat_0={latitude_centre} +lon_0={longitude_centre}") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Gall projection")
longitude_centre <- -100
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=gall +lat_0={latitude_centre} +lon_0={longitude_centre}") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Gall projection")
xlim = c(-4200000, 8600000)
ylim = c(1200000,8400000)
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Mollweide projection & zoom")+
coord_sf(xlim=xlim,ylim=ylim)
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll")
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
names
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
bbox
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
st_bbox()
ne_countries(scale = 110, returnclass = "sf") %>%
#Accès aux limites
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
st_bbox()
#Accès aux limites
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
st_bbox()
ne_countries(scale = 110, returnclass = "sf") %>%
st_bbox()
ne_countries(scale = 110, returnclass = "sf") %>%
st_transform("+proj=moll") %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
ggtitle("Mollweide projection & zoom")+
coord_sf(xlim=xlim,ylim=ylim)
latitude_centre <- 52
longitude_centre <- 10
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
st_bbox()
xlim = c(-4200000, 8600000)
ylim = c(1200000,8400000)
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_sf(xlim=xlim,ylim=ylim)
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs"))
latitude_centre <- 52
longitude_centre <- 10
crsLONGLAT <- "+proj=longlat +datum=WGS84 +no_defs"
# crsLAEA <- "+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +datum=WGS84 +units=m +no_defs"
crsLAEA <- glue("+proj=laea +lat_0={latitude_centre} +lon_0={laongitude_centre} +datum=WGS84 +units=m +no_defs")
latitude_centre <- 52
longitude_centre <- 10
xlim=c(-42, 52)
ylim=c(20,84)
crsLONGLAT <- "+proj=longlat +datum=WGS84 +no_defs"
# crsLAEA <- "+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +datum=WGS84 +units=m +no_defs"
crsLAEA <- glue("+proj=laea +lat_0={latitude_centre} +lon_0={laongitude_centre} +datum=WGS84 +units=m +no_defs")
# crsLAEA <- "+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +datum=WGS84 +units=m +no_defs"
crsLAEA <- glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")
# the bouding box polygon in long/lat projection, i.e. axis-aligned
bb <- st_sfc(
st_polygon(list(cbind(
xlim[c(1,2,2,1,1)], # x-coordinates (longitudes) of points A,B,C,D
ylim[c(1,1,2,2,1)]     # y-coordinates (latitudes) of points A,B,C,D
))),
crs = "+proj=longlat +datum=WGS84 +no_defs")
# now in in LAEA projection
laeabb <- st_transform(bb, crs = crsLAEA)
# the extent of the bounding box in the new projection
b <- st_bbox(laeabb)
gg2 <- ggplot(data = ctrys) +
geom_sf(fill = "grey", colour = "black") +
coord_sf(crs = crsLAEA, xlim = c(b["xmin"], b["xmax"]), ylim = c(b["ymin"], b["ymax"]))
gg2
ggplot(data = ctrys) +
geom_sf(aes(fill = pop_est), colour = "black") +
coord_sf(crs = crsLAEA, xlim = c(b["xmin"], b["xmax"]), ylim = c(b["ymin"], b["ymax"]))
ne_countries(scale=110, returnclass = "sf") %>%
ggplot()+
geom_sf(aes(fill = pop_est), colour = "black") +
coord_sf(crs = crsLAEA, xlim = c(b["xmin"], b["xmax"]), ylim = c(b["ymin"], b["ymax"]))
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")+
coord_sf(xlim=xlim,ylim=ylim)
ne_countries(scale=110, returnclass = "sf") %>%
st_transform(w, crs = glue("+proj=laea +lat_0={latitude_centre} +lon_0={longitude_centre} +datum=WGS84 +units=m +no_defs")) %>%
ggplot() +
geom_sf(aes(fill = pop_est), colour = "black")
ne_countries(scale=110, returnclass = "sf") %>%
ggplot()+
geom_sf(aes(fill = pop_est), colour = "black") +
coord_sf(crs = crsLAEA, xlim = c(b["xmin"], b["xmax"]), ylim = c(b["ymin"], b["ymax"]))
data_ue <- read_rds("data_ue.rds")
data_ue
ne_countries(scale=110, returnclass = "sf")
ne_countries(scale=50, returnclass = "sf")
ne_countries(scale=110, returnclass = "sf")
ne_countries(scale=110, returnclass = "sf") %>%
distinct(name)
ne_countries(scale=110, returnclass = "sf") %>%
distinct(name)
rm(list=ls())
library(srpdata)
library(readxl)
library(tidyverse)
library(sf)
library(glue)
library(ggplot2)
library(gdata)
library(plotly)
#---------------------------------------------------------------------------------------
#COLZA
# list.files("DATA/",pattern = "xls$",full.names = TRUE)
excel_sheets("DATA/OLEAUE.xlsx")
#---------------------------------------------------------------------------------------
#COLZA
# list.files("DATA/",pattern = "xls$",full.names = TRUE)
excel_sheets("DATA/OLEAUE.xls")
colza <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfColza",
sheet_prod="ProdColza",
sheet_rdt = "RdtColza",
culture = "Colza",
skip = 3, n_max=27)
colza <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfColza",
sheet_prod="ProdColza",
sheet_rdt = "RdtColza",
culture = "Colza",
skip = 3, n_max=30)
rm(list=ls())
library(srpdata)
library(readxl)
library(tidyverse)
library(sf)
library(glue)
library(ggplot2)
library(gdata)
library(plotly)
#---------------------------------------------------------------------------------------
#COLZA UE
excel_sheets("DATA/OLEAUE.xls")
colza <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfColza",
sheet_prod="ProdColza",
sheet_rdt = "RdtColza",
culture = "Colza",
skip = 3, n_max=30)
rm(list=ls())
library(srpdata)
library(readxl)
library(tidyverse)
library(sf)
library(glue)
library(ggplot2)
library(gdata)
library(plotly)
colza <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfColza",
sheet_prod="ProdColza",
sheet_rdt = "RdtColza",
culture = "Colza",
skip = 3, n_max=30)
rdt <- test_and_import(sheet = "RdtColza" ,path = "./DATA/OLEAUE.xls", skip = 3 , n_max = 30, critere="Rendement")
rdt
View(rdt)
surface <- test_and_import(sheet = "SurfColza" , path = "./DATA/OLEAUE.xls", skip = 3 , n_max = 30, critere="Surface")
production <- test_and_import(sheet = "ProdColza" ,path = "./DATA/OLEAUE.xls", skip = 3 , n_max = 30, critere="Production")
surface %>%
bind_rows(rdt,production)
surface %>%
bind_rows(rdt,production) %>%
select(X__1,CRITERE, everything())
surface %>%
bind_rows(rdt,production) %>%
select(X__1,CRITERE, everything()) %>%
gather(key = ANNEE,value = VALUE,3:ncol(.))
surface %>%
bind_rows(rdt,production) %>%
select(X__1,CRITERE, everything()) %>%
gather(key = ANNEE,value = VALUE,3:ncol(.)) %>%
mutate(CULTURE=culture,
MAJ=maj,
ANNEE = as.numeric(as.character(substr(ANNEE,1,4))),
VALUE=as.numeric(VALUE))
surface %>%
bind_rows(rdt,production) %>%
select(X__1,CRITERE, everything()) %>%
gather(key = ANNEE,value = VALUE,3:ncol(.))
surface %>%
bind_rows(rdt,production) %>%
select(X__1,CRITERE, everything()) %>%
gather(key = ANNEE,value = VALUE,3:ncol(.)) %>%
mutate(CULTURE="Colza",
ANNEE = as.numeric(as.character(substr(ANNEE,1,4))),
VALUE=as.numeric(VALUE)) %>%
mutate_if(is.character,as.factor) %>%
rename(PAYS = "X__1")
# Chunk 1: setup
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
# Chunk 2
rm(list=ls())
library(srpdata)
library(readxl)
library(tidyverse)
library(sf)
library(glue)
library(ggplot2)
library(gdata)
library(plotly)
colza <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfColza",
sheet_prod="ProdColza",
sheet_rdt = "RdtColza",
culture = "Colza",
skip = 3, n_max=30)
colza
View(colza)
#---------------------------------------------------------------------------------------
#COLZA UE
excel_sheets("DATA/OLEAUE.xls")
#---------------------------------------------------------------------------------------
#SOJA
# excel_sheets("DATA/PRODUCTIONS OLEAGINEUX UE.xls")
soja <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfSoja",
sheet_prod="ProdSoja",
sheet_rdt = "RdtSoja",
culture = "Soja",
skip = 3, n_max=30)
#---------------------------------------------------------------------------------------
#TOURNESOL
# excel_sheets("DATA/PRODUCTIONS OLEAGINEUX UE.xls")
tourn <- import_srp_monde(path="./DATA/OLEAUE.xls",
sheet_surf = "SurfTourn",
sheet_prod="ProdTourn",
sheet_rdt = "RdtTourn",
culture = "Tournesol",
skip = 3, n_max=30)
#---------------------------------------------------------------------------------------
#TOURNESOL
excel_sheets("DATA/PROTEAUE.xls")
pois <- import_srp_monde(path="./DATA/PROTEAUE.xls",
sheet_surf = "SurPois",
sheet_prod="ProdPois",
sheet_rdt = "RdtPois",
culture = "Pois protéagineux",
skip = 3, n_max=15)
pois <- import_srp_monde(path="./DATA/PROTEAUE.xls",
sheet_surf = "SurPois",
sheet_prod="ProdPois",
sheet_rdt = "RdtPois",
culture = "Pois protéagineux",
skip = 3, n_max=15)
pois <- import_srp_monde(path="./DATA/PROTEAUE.xls",
sheet_surf = "SurPois",
sheet_prod="ProdPois",
sheet_rdt = "RdtPois",
culture = "Pois protéagineux",
skip = 3, n_max=15)
pois <- import_srp_monde(path="./DATA/PROTEAUE.xls",
sheet_surf = "SurPois",
sheet_prod="ProdPois",
sheet_rdt = "RdtPois",
culture = "Pois protéagineux",
skip = 3, n_max=28)
pois <- import_srp_monde(path="./DATA/PROTEAUE.xls",
sheet_surf = "SurPois",
sheet_prod="ProdPois",
sheet_rdt = "RdtPois",
culture = "Pois protéagineux",
skip = 3, n_max=28)
pois <- import_srp_monde(path="./DATA/PROTEAUE.xls",
sheet_surf = "SurPois",
sheet_prod="ProdPois",
sheet_rdt = "RdtPois",
culture = "Pois protéagineux",
skip = 3, n_max=28)
